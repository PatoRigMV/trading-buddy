{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/schemas/trading_assistant_spec.json",
  "title": "LLM Trading Assistant Training Specification",
  "type": "object",
  "required": ["trading_assistant_spec"],
  "properties": {
    "trading_assistant_spec": {
      "type": "object",
      "required": ["meta", "governance", "risk_management", "trade_execution", "portfolio_management", "analysis_framework", "real_time_reactions", "compliance_ethics", "continuous_learning"],
      "properties": {
        "meta": {
          "type": "object",
          "required": ["goal", "deployment_phases"],
          "properties": {
            "goal": { "type": "string" },
            "deployment_phases": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "Paper trading with broker/testnet API",
                  "Small real-capital pilot (<$5k)",
                  "Scaled deployment with circuit breakers"
                ]
              },
              "minItems": 1,
              "uniqueItems": true
            }
          },
          "additionalProperties": false
        },

        "governance": {
          "type": "object",
          "required": ["autonomy_levels", "logging", "refusal_protocols"],
          "properties": {
            "autonomy_levels": {
              "type": "object",
              "required": ["proposal", "approval"],
              "properties": {
                "proposal": { "type": "string", "const": "LLM may propose trades with structured rationale" },
                "approval": { "type": "string", "const": "Human required for execution during pilot phase" },
                "autonomy": { "type": "string", "const": "LLM may execute within guardrails after performance validation" }
              },
              "additionalProperties": false
            },
            "logging": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "All trade proposals logged with rationale, risk metrics, and compliance checks",
                  "Weekly performance review auto-generated by LLM"
                ]
              },
              "minItems": 1,
              "uniqueItems": true
            },
            "refusal_protocols": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "If conviction < threshold (e.g., <60%)",
                  "If risk budget exceeded",
                  "If conflicting signals detected"
                ]
              },
              "minItems": 1,
              "uniqueItems": true
            }
          },
          "additionalProperties": false
        },

        "risk_management": {
          "type": "object",
          "required": ["position_sizing", "portfolio_exposure", "monitoring"],
          "properties": {
            "position_sizing": {
              "type": "object",
              "required": ["max_risk_per_trade", "methods", "stop_loss"],
              "properties": {
                "max_risk_per_trade": { "type": "number", "minimum": 0, "maximum": 0.05, "default": 0.02 },
                "methods": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "Kelly Criterion",
                      "Fixed Fractional",
                      "Volatility-adjusted sizing"
                    ]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "stop_loss": { "type": "string", "enum": ["Always defined pre-trade"] }
              },
              "additionalProperties": false
            },
            "portfolio_exposure": {
              "type": "object",
              "required": ["max_single_security", "max_asset_class", "diversification"],
              "properties": {
                "max_single_security": { "type": "number", "minimum": 0, "maximum": 0.1, "default": 0.05 },
                "max_asset_class": { "type": "number", "minimum": 0, "maximum": 0.5, "default": 0.2 },
                "diversification": { "type": "string", "enum": ["Across sectors, geographies, factors"] }
              },
              "additionalProperties": false
            },
            "monitoring": {
              "type": "object",
              "required": ["metrics", "circuit_breakers", "stress_tests"],
              "properties": {
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Sharpe", "Sortino", "Max Drawdown", "VaR", "Beta"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "circuit_breakers": {
                  "type": "object",
                  "required": ["portfolio_loss", "single_day_loss"],
                  "properties": {
                    "portfolio_loss": { "type": "number", "maximum": 0, "default": -0.10 },
                    "single_day_loss": { "type": "number", "maximum": 0, "default": -0.03 }
                  },
                  "additionalProperties": false
                },
                "stress_tests": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["2008 crisis", "COVID crash", "High inflation regime"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },

        "trade_execution": {
          "type": "object",
          "required": ["order_management", "entry_exit", "transaction_costs"],
          "properties": {
            "order_management": {
              "type": "object",
              "required": ["order_types", "avoid_periods", "slippage_modeling"],
              "properties": {
                "order_types": {
                  "type": "array",
                  "items": { "type": "string", "enum": ["Limit", "TWAP", "VWAP"] },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "avoid_periods": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Market open/close", "Low liquidity holidays"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "slippage_modeling": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            },
            "entry_exit": {
              "type": "object",
              "required": ["entry_signals", "exit_rules", "scaling"],
              "properties": {
                "entry_signals": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Technical", "Fundamental", "Quantitative confirmation"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "exit_rules": {
                  "type": "object",
                  "required": ["profit_target", "stop_loss", "trailing_stop"],
                  "properties": {
                    "profit_target": { "type": "string", "description": "Predefined % return or rule reference" },
                    "stop_loss": { "type": "string", "description": "Predefined % risk or rule reference" },
                    "trailing_stop": { "type": "string", "description": "Volatility-based or ATR-based adjustment" }
                  },
                  "additionalProperties": false
                },
                "scaling": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "Scale-in for conviction builds",
                      "Scale-out to lock profits"
                    ]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                }
              },
              "additionalProperties": false
            },
            "transaction_costs": {
              "type": "object",
              "required": ["factor_costs", "tax_considerations", "turnover_limits"],
              "properties": {
                "factor_costs": { "type": "boolean", "default": true },
                "tax_considerations": { "type": "boolean", "default": true },
                "turnover_limits": { "type": "number", "minimum": 0, "maximum": 2, "default": 0.5 }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },

        "portfolio_management": {
          "type": "object",
          "required": ["allocation", "temporal_diversification"],
          "properties": {
            "allocation": {
              "type": "object",
              "required": ["asset_classes", "rebalancing", "geographic_diversification", "sector_limit"],
              "properties": {
                "asset_classes": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Equities", "Fixed Income", "Commodities", "Alternatives"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "rebalancing": {
                  "type": "string",
                  "enum": ["Quarterly or when drift > 5%"]
                },
                "geographic_diversification": { "type": "boolean", "default": true },
                "sector_limit": { "type": "number", "minimum": 0, "maximum": 0.3, "default": 0.15 }
              },
              "additionalProperties": false
            },
            "temporal_diversification": {
              "type": "object",
              "required": ["dollar_cost_averaging", "multiple_time_horizons"],
              "properties": {
                "dollar_cost_averaging": { "type": "boolean", "default": true },
                "multiple_time_horizons": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Short-term tactical", "Long-term strategic"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },

        "analysis_framework": {
          "type": "object",
          "required": ["technical", "fundamental", "quantitative"],
          "properties": {
            "technical": {
              "type": "object",
              "required": ["tools", "multi_timeframe"],
              "properties": {
                "tools": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Moving Averages", "MACD", "RSI", "ADX", "Support/Resistance"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "multi_timeframe": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Daily", "Weekly", "Monthly"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                }
              },
              "additionalProperties": false
            },
            "fundamental": {
              "type": "object",
              "required": ["metrics", "governance", "macro"],
              "properties": {
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "Revenue growth",
                      "Profitability",
                      "Debt levels",
                      "Valuations (P/E, EV/EBITDA)"
                    ]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "governance": { "type": "string", "enum": ["Evaluate management quality"] },
                "macro": { "type": "string", "enum": ["Incorporate industry & economic factors"] }
              },
              "additionalProperties": false
            },
            "quantitative": {
              "type": "object",
              "required": ["models", "validation"],
              "properties": {
                "models": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "Factor models",
                      "ML pattern recognition",
                      "Monte Carlo stress tests"
                    ]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "validation": {
                  "type": "string",
                  "enum": ["Walk-forward & bootstrap testing"]
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },

        "real_time_reactions": {
          "type": "object",
          "required": ["news_processing", "event_driven", "volatility_management"],
          "properties": {
            "news_processing": {
              "type": "object",
              "required": ["sources", "filters", "sentiment_analysis"],
              "properties": {
                "sources": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Bloomberg", "Reuters", "Official filings"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "filters": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Relevance", "Credibility", "Market impact"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "sentiment_analysis": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            },
            "event_driven": {
              "type": "object",
              "required": ["protocols"],
              "properties": {
                "protocols": {
                  "type": "object",
                  "required": ["earnings", "central_bank", "geopolitics"],
                  "properties": {
                    "earnings": { "type": "string", "enum": ["Rapid reassessment of positions"] },
                    "central_bank": { "type": "string", "enum": ["Pause discretionary trades Â±1hr around announcement"] },
                    "geopolitics": { "type": "string", "enum": ["Scenario analysis before execution"] }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            },
            "volatility_management": {
              "type": "object",
              "required": ["metrics", "adjust_position_size", "hedging"],
              "properties": {
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["VIX", "IV rank"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "adjust_position_size": { "type": "boolean", "default": true },
                "hedging": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Options strategies", "Inverse ETFs"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },

        "compliance_ethics": {
          "type": "object",
          "required": ["regulatory", "ethics", "disclosures"],
          "properties": {
            "regulatory": {
              "type": "object",
              "required": ["record_keeping", "insider_trading_protocols", "reporting_thresholds"],
              "properties": {
                "record_keeping": { "type": "boolean", "default": true },
                "insider_trading_protocols": { "type": "boolean", "default": true },
                "reporting_thresholds": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            },
            "ethics": {
              "type": "object",
              "required": ["no_market_manipulation", "transparency", "ESG_considerations"],
              "properties": {
                "no_market_manipulation": { "type": "boolean", "default": true },
                "transparency": { "type": "boolean", "default": true },
                "ESG_considerations": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            },
            "disclosures": {
              "type": "object",
              "required": ["client_risk_disclosures", "decision_documentation", "suitability_assessment"],
              "properties": {
                "client_risk_disclosures": { "type": "boolean", "default": true },
                "decision_documentation": { "type": "boolean", "default": true },
                "suitability_assessment": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },

        "continuous_learning": {
          "type": "object",
          "required": ["performance_analysis", "strategy_evolution", "regime_detection"],
          "properties": {
            "performance_analysis": {
              "type": "object",
              "required": ["metrics", "attribution"],
              "properties": {
                "metrics": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": [
                      "Returns", "Volatility", "Sharpe", "Sortino",
                      "Max Drawdown", "Alpha", "Information Ratio"
                    ]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "attribution": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["By asset class", "By sector", "By strategy"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                }
              },
              "additionalProperties": false
            },
            "strategy_evolution": {
              "type": "object",
              "required": ["model_updates", "backtesting", "forward_testing"],
              "properties": {
                "model_updates": { "type": "string", "enum": ["Quarterly review or regime shift"] },
                "backtesting": { "type": "string", "enum": ["Rolling 10-year historical data"] },
                "forward_testing": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            },
            "regime_detection": {
              "type": "object",
              "required": ["regimes", "adjustments", "ensemble_methods"],
              "properties": {
                "regimes": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["Bull", "Bear", "Sideways", "Volatility spike"]
                  },
                  "minItems": 1,
                  "uniqueItems": true
                },
                "adjustments": { "type": "string", "enum": ["Adaptive risk & position sizing per regime"] },
                "ensemble_methods": { "type": "boolean", "default": true }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  }
}
